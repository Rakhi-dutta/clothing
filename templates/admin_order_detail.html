{% extends "base.html" %}
{% block content %}

<div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-3">
    <div>
        <h3 class="fw-bold mb-0">Order Details</h3>
        <div class="text-muted small">{{ order.order_number }}</div>
    </div>
    <a class="btn btn-outline-secondary btn-sm" href="{{ url_for('admin_orders') }}">
        <i class="bi bi-arrow-left"></i> Back
    </a>
</div>

<div class="row g-3">
    <div class="col-lg-7">
        <div class="card shadow-sm p-4">
            <h5 class="fw-semibold mb-3">Items</h5>
            <div class="table-responsive">
                <table class="table align-middle mb-0">
                    <thead>
                        <tr>
                            <th style="width:80px;">Image</th>
                            <th>Product</th>
                            <th style="width:120px;">Size</th>
                            <th style="width:120px;">Qty</th>
                            <th style="width:140px;">Price</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for it in items %}
                        <tr>
                            <td>
                                {% if it.image %}
                                <img src="{{ url_for('uploaded_file', filename=it.image) }}"
                                     style="width:60px;height:60px;object-fit:cover;border-radius:10px;">
                                {% else %}
                                <span class="text-muted small">—</span>
                                {% endif %}
                            </td>
                            <td class="fw-semibold">{{ it.name }}</td>
                            <td>{{ it.size }}</td>
                            <td>{{ it.quantity }}</td>
                            <td>₹ {{ '%.2f'|format(it.price) }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="col-lg-5">
        <div class="card shadow-sm p-4 mb-3">
            <h5 class="fw-semibold mb-2">Customer</h5>
            <div class="fw-semibold">{{ customer.name }}</div>
            <div class="text-muted small">{{ customer.email }}</div>
            <div class="text-muted small">{{ customer.phone or '' }}</div>
            <hr>
            <div class="text-muted small">Shipping Address</div>
            <div class="fw-semibold">{{ order.shipping_address }}</div>
        </div>

        <div class="card shadow-sm p-4">
            <h5 class="fw-semibold mb-3">Update Status</h5>
            <form method="POST" action="{{ url_for('update_order_status', order_id=order.id) }}">
                <label class="form-label mb-1">Status</label>
                <select class="form-select mb-3" name="status">
                    {% for st in ['pending','confirmed','shipped','delivered','cancelled'] %}
                    <option value="{{ st }}" {% if order.status==st %}selected{% endif %}>{{ st|title }}</option>
                    {% endfor %}
                </select>

                <label class="form-label mb-1">Notes</label>
                <textarea class="form-control mb-3" name="notes" rows="3">{{ order.notes or '' }}</textarea>

                <div class="d-flex justify-content-between align-items-center">
                    <div class="fw-bold">Total: ₹ {{ '%.2f'|format(order.total_amount) }}</div>
                    <button class="btn btn-primary">
                        <i class="bi bi-check2-circle"></i> Save
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

{% endblock %}

